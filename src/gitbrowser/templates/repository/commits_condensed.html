{% extends "repository_template.html" %}
{% load gb_tags %}
{% load humanize %}
{% load bootstrap3 %}

{% block title %}Commits in {{repository.name}}{% if repository.path %} :: {{repository.path}}{% endif %}{% endblock %}

{% block repository_content %}

{% regroup commits by committed_datetime.date as grouped_commits %}

	<table class="table">
		{% for commit_group in grouped_commits %}
			<tr>
				<td colspan="3">
					<h5 class="text-muted" title="{{commit_group.grouper|naturalday}}">Commits on {{commit_group.grouper}}</h5>
				</td>
			</tr>

			{% for commit in commit_group.list %}
				<tr itemscope itemtype="http://schema.org/CreativeWork">
					<td>{% author_tag commit.author %}</td>
					<td>
						<a href="{% url 'commit' repository.relative_path commit.hexsha %}"
						   itemprop="url"
						   title="{{commit.summary}}"><span itemprop="headline">{{commit.summary|default:"(no message)"}}</span></a>
					</td>
					<td>
						{% time_tag commit.committed_datetime itemprop="dateCreated" %}
					</td>
				</tr>
			{% endfor %}
		{% endfor %}
	</table>

{% comment %}
		<ul class="media-list commit-list" itemscope itemtype="http://schema.org/ItemList">
			<meta itemprop="itemListOrder" content="http://schema.org/ItemListOrderDescending" />
			{% for commit in commit_group.list %}
				<li class="media" itemscope itemtype="http://schema.org/CreativeWork">
					<div class="media-left">
						<img class="media-object img-rounded"
							 src="{% url 'avatar' %}?email={{commit.committer.email}}&size=40"
							 alt="{{commit.committer.name}}" title="{{commit.committer.name}}">
					</div>
					<div class="media-body">
						<h4 class="media-heading">
							<a href="{% url 'commit' repository.relative_path commit.hexsha %}"
							   itemprop="url"
							   title="{{commit.summary}}"><span itemprop="headline">{{commit.summary|default:"(no message)"}}</span></a>
						</h4>
						<p class="text-muted">
							{% author_tag commit.author with_avatar=False %}, {% time_tag commit.committed_datetime itemprop="dateCreated" %}
						</p>
					</div>
				</li>
			{% endfor %}
		</ul>
<hr />
{% endcomment %}


	{% bootstrap_pagination commits %}

{% endblock %}